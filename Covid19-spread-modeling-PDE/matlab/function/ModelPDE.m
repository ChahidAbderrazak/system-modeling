function [Sn1,In1,Rn1,Dn1]= ModelPDE(Nx,Lx,dt,X0,Nn,DiffCoefS,DiffCoefI,DiffCoefR,DiffCoefD,kappa,beta,gamma,delta)
%% ================================================================ 


dx=Lx/(Nx-1);
%% ================================================================ 

%% ################################################################
%%                   Assemblage of Global Matrix
%% ################################################################
Lambda=1/(dx*dx);
Ix=-2*Lambda*ones(Nx,1);
Ix1=Lambda*ones(Nx-1,1);
Ix2=Lambda*ones(Nx-1,1);
Matr=diag(Ix)+diag(Ix1,1)+diag(Ix2,-1);
%% Boundary Term
Matr(1,1)=Matr(1,1)+Lambda;
Matr(Nx,Nx)=Matr(Nx,Nx)+Lambda;
%%  ================================================================================== 
%%  ================================================================================== 
%%  ================================================================================== 
Sn=X0(:,1);
In=X0(:,2);
Rn=X0(:,3);
Dn=X0(:,4);
%%  ================================================================================== 
Sn1=Sn + dt*DiffCoefS*Matr*Sn  - dt*(1./Nn)*beta*(1-kappa).*Sn.*In;

%% ================================================================ 

In1=In + dt*DiffCoefI*Matr*In + dt*(1./Nn)*beta*(1-kappa).*Sn.*In -dt*gamma*(1-delta)*In-dt*delta*In ;


%% ================================================================ 

Rn1=Rn +dt*DiffCoefR*Matr*Rn + dt*gamma*(1-delta)*In;

%% ================================================================ 

Dn1=Dn +dt*DiffCoefD*Matr*Dn + dt*delta*In;



end